<?xml version='1.0' encoding='UTF-8' ?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<ui:composition template = "WEB-INF/template.xhtml" xmlns="http://www.w3.org/1999/xhtml"
                xmlns:h="http://xmlns.jcp.org/jsf/html"
                xmlns:ui="http://xmlns.jcp.org/jsf/facelets"
                xmlns:f ="http://java.sun.com/jsf/core"
                xmlns:p ="http://primefaces.org/ui">


    <ui:define name="content">
        <h3> Unterartikel-Übersicht</h3>
        <h:form>
            <p:dataTable value="#{childArticleOverviewController.articles}" id = "articleOverview" var="article" scrollable="true" scrollHeight="90%" scrollWidth="100%">
                <p:column filterBy="parentArticleName" sortBy="parentArticleName" headerText="Artikelname" filterMatchMode="contains" filterStyle="width: 100%">
                    <h:outputText value ="#{article.parentArticleName}"></h:outputText>
                </p:column>
                <p:column  sortBy="ean" headerText="EAN" filterMatchMode="contains" filterBy="ean" filterStyle="width: 100%">                    
                    <h:outputText value ="#{article.ean}"></h:outputText>
                </p:column>  
                <p:column sortBy="sku" headerText="SKU" filterMatchMode="contains" filterBy="ean" filterStyle="width: 100%">                  
                    <h:outputText value ="#{article.sku}"></h:outputText>
                </p:column>
                <p:column sortBy="manufacturerSKU" headerText="Hersteller-SKU" filterMatchMode="contains" filterBy="manufacturerSKU" filterStyle="width: 100%">
                    <h:outputText value ="#{article.manufacturerSKU}"></h:outputText>
                </p:column>
                <p:column sortBy="size.name" headerText="Größe" filterMatchMode="contains" filterBy="size.name" filterStyle="width: 100%">
                    <h:outputText value="#{article.size.name}"></h:outputText>
                </p:column>
                <p:column  sortBy="quantity" headerText="Bestand" filterMatchMode="contains" filterBy="quantity" filterStyle="width: 100%">                  
                    <h:outputText value ="#{article.quantity}"/>
                </p:column>
                <p:column sortBy="purchasePrice" headerText="Einkaufspreis" filterMatchMode="contains" filterBy="purchasePrice" filterStyle="width: 100%">
                    <h:outputText value ="#{article.purchasePrice}">
                        <f:convertNumber type="currency" locale = "de_de" />
                    </h:outputText>
                </p:column>
                <p:column sortBy="shopPrice" headerText="Shop-Preis" filterMatchMode="contains" filterBy="shopPrice" filterStyle="width: 100%">
                    <h:outputText value ="#{article.shopPrice}">
                        <f:convertNumber type="currency" locale = "de_de" />
                    </h:outputText>
                </p:column>
                <p:column sortBy="ebayPrice" headerText="Ebay-Preis" filterMatchMode="contains" filterBy="ebayPrice" filterStyle="width: 100%">
                    <h:outputText value ="#{article.ebayPrice}">
                        <f:convertNumber  type="currency" locale = "de_de"/>
                        <!--<f:convertNumber currencySymbol ="€" type="currency" locale = "de" maxFractionDigits="2" pattern="###,##0.00" />-->
                    </h:outputText>
                </p:column>
                <p:column sortBy="amazonPrice" headerText="Amazon-Preis" filterMatchMode="contains" filterBy="amazonPrice" filterStyle="width: 100%">
                    <h:outputText value ="#{article.amazonPrice}">
                        <f:convertNumber type="currency" locale = "de_de" />
                    </h:outputText>
                </p:column>
                <p:column>
                    <p:commandButton value="Bearbeiten"  oncomplete ="caEditWidget.show();" update=":caEdit" >
                        <f:setPropertyActionListener target="#{childArticleEditController.childArticle}" value="#{article}"  />
                    </p:commandButton>
                </p:column>
            </p:dataTable>
        </h:form>

        <p:dialog id="caEdit" header="Unterartikel bearbeiten" widgetVar="caEditWidget">
            <h:form>
                <p:panelGrid columns="2">
                    <p:outputLabel value="Artikelname"></p:outputLabel>
                    <h:outputText value ="#{childArticleEditController.childArticle.parentArticleName}"></h:outputText>

                    <p:outputLabel value="EAN"></p:outputLabel>                   
                    <p:inputText value ="#{childArticleEditController.childArticle.ean}">
                        <f:validateLength minimum="13" maximum="13" />
                    </p:inputText>                  

                    <p:outputLabel value="SKU"></p:outputLabel>                    
                    <h:outputText value ="#{childArticleEditController.childArticle.sku}"></h:outputText>                

                    <p:outputLabel value="Hersteller-SKU"></p:outputLabel>                     
                    <p:inputText value ="#{childArticleEditController.childArticle.manufacturerSKU}"></p:inputText>

                    <p:outputLabel value="Größe"></p:outputLabel>
                    <p:selectOneMenu value="#{childArticleEditController.childArticle.size}">                    
                        <f:selectItems value ="#{selectManySizeBean.getSizeListByType(childArticleEditController.childArticle.attribute.name)}" var = "size" itemLabel="#{size.name}" itemValue="#{size.name}"/>
                        <f:converter converterId="sizeConverter" />
                    </p:selectOneMenu>

                    <p:outputLabel value="Bestand"></p:outputLabel>                    
                    <h:outputText value ="#{childArticleEditController.childArticle.quantity}"> 
                        <f:convertNumber minFractionDigits="0" /> 
                    </h:outputText>

                    <p:outputLabel value="Einkaufspreis"></p:outputLabel>                   
                    <p:inputText value ="#{childArticleEditController.childArticle.purchasePrice}">
                        <f:convertNumber minFractionDigits="2" pattern="#,00" /> 
                    </p:inputText>

                    <p:outputLabel value="Shop-Preis"></p:outputLabel>
                    <p:inputText value ="#{childArticleEditController.childArticle.shopPrice}">
                        <f:convertNumber minFractionDigits="2" pattern="#,00"/> 
                    </p:inputText>

                    <p:outputLabel value="Ebay-Preis"></p:outputLabel>
                    <p:inputText value ="#{childArticleEditController.childArticle.ebayPrice}">
                        <f:convertNumber minFractionDigits="2" pattern="#,00"/> 
                    </p:inputText>

                    <p:outputLabel value="Amazon-Preis"></p:outputLabel>
                    <p:inputText value ="#{childArticleEditController.childArticle.amazonPrice}">
                        <f:convertNumber minFractionDigits="2" pattern="#,00"/> 
                    </p:inputText> 
                    <p:commandButton value="Speichern" action ="#{childArticleEditController.doSave()}" oncomplete="caEditWidget.hide();">
                        <p:ajax update=":j_idt21:articleOverview"/>
                        <f:setPropertyActionListener target="#{childArticleEditController.newChildArticle}" value="#{childArticleEditController.newChildArticle}"/>
                    </p:commandButton>
                </p:panelGrid>
            </h:form> 
        </p:dialog>

    </ui:define>
</ui:composition>

